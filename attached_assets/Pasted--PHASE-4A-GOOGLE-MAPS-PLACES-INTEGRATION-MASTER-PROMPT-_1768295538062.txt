
üîí PHASE 4A ‚Äî GOOGLE MAPS & PLACES INTEGRATION

MASTER PROMPT (STRICT ¬∑ ZERO FEATURE CREEP)

You are implementing Google Maps & Places as an assistive UX layer only, NOT as a hard dependency.

This is a correction + hardening task, not a redesign.

‚∏ª

1Ô∏è‚É£ CORE PRINCIPLES (NON-NEGOTIABLE)
	1.	Google Maps must NEVER block any form
	‚Ä¢	If Maps fails to load, all forms must still function
	‚Ä¢	Manual text entry must always be available
	‚Ä¢	No runtime crashes, no disabled submit buttons
	2.	Google Maps is OPTIONAL UX, not validation authority
	‚Ä¢	Validation is server-driven
	‚Ä¢	Google data may prefill, never enforce
	3.	One shared address architecture
	‚Ä¢	Same logic across:
	‚Ä¢	Vendor registration
	‚Ä¢	Checkout
	‚Ä¢	Buyer profile
	‚Ä¢	No duplicated logic or hardcoded city lists

‚∏ª

2Ô∏è‚É£ MAPS ENABLEMENT (FIX THIS FIRST)

‚ùå REMOVE
	‚Ä¢	Any Zustand/store-based isMapsEnabled
	‚Ä¢	Any async script-load dependent gating

‚úÖ IMPLEMENT

export const isMapsEnabled = () =>
  Boolean(process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY);

	‚Ä¢	This check is synchronous
	‚Ä¢	This check is the ONLY gate
	‚Ä¢	Script load failure must degrade gracefully

‚∏ª

3Ô∏è‚É£ AUTOCOMPLETE BEHAVIOR (STRICT)

City Field
	‚Ä¢	Use Google Places Autocomplete only if Maps enabled
	‚Ä¢	Config:

types: ['(cities)']
componentRestrictions: { country: 'gh' }

Fallback
	‚Ä¢	If Maps disabled or script fails:
	‚Ä¢	Render plain text input
	‚Ä¢	Same validation rules apply

‚∏ª

4Ô∏è‚É£ REGION HANDLING (IMPORTANT)
	‚Ä¢	Region auto-fills from Google (administrative_area_level_1)
	‚Ä¢	Region MUST remain editable by user
	‚Ä¢	Region is validated on submit, not selection

‚∏ª

5Ô∏è‚É£ DATA EXTRACTION RULES

From Google PlaceDetails extract ONLY:
	‚Ä¢	locality ‚Üí city
	‚Ä¢	administrative_area_level_1 ‚Üí region
	‚Ä¢	postal_code ‚Üí optional

üö´ DO NOT store:
	‚Ä¢	Place IDs
	‚Ä¢	Full Google payloads
	‚Ä¢	Lat/Lng (out of scope)

‚∏ª

6Ô∏è‚É£ ADDRESS DATA MODEL (LOCK THIS)

All forms must submit:

address: {
  line1: string
  city: string
  region: string
  country: 'GH'
  postalCode?: string
  source: 'google' | 'manual'
}

	‚Ä¢	source is required
	‚Ä¢	Manual edits must flip source to manual

‚∏ª

7Ô∏è‚É£ VALIDATION RULES (DO NOT CHANGE)
	‚Ä¢	Address line: required
	‚Ä¢	City: 2‚Äì50 chars, human-readable
	‚Ä¢	Region: optional but validated if present
	‚Ä¢	Postal code: optional (Ghana-specific)
	‚Ä¢	‚ùå No Google-dependent validation

‚∏ª

8Ô∏è‚É£ HARD REMOVALS

You MUST remove:
	‚Ä¢	GHANA_CITIES constants
	‚Ä¢	Any static dropdowns for city/region
	‚Ä¢	Any logic assuming Maps is always available

‚∏ª

9Ô∏è‚É£ TESTING REQUIREMENTS (MANDATORY)

You must verify:
	1.	Forms submit successfully with:
	‚Ä¢	Maps enabled
	‚Ä¢	Maps disabled
	‚Ä¢	Script load failure
	2.	User can:
	‚Ä¢	Override Google-filled city/region
	‚Ä¢	Manually type everything
	3.	No console errors
	4.	No crashes inside ErrorBoundary
	5.	Same behavior across all 3 forms

‚∏ª

üö´ OUT OF SCOPE (DO NOT TOUCH)
	‚Ä¢	Payment flows
	‚Ä¢	Validation rules unrelated to address
	‚Ä¢	UI redesigns
	‚Ä¢	Schema migrations
	‚Ä¢	Admin features

‚∏ª

‚úÖ COMPLETION CRITERIA

This task is complete ONLY when:
	‚Ä¢	All forms work without Google Maps
	‚Ä¢	Google enhances UX but never blocks
	‚Ä¢	No static city data remains
	‚Ä¢	One shared, reusable AddressAutocomplete component exists

If any rule above is violated, STOP and FIX before proceeding.