PHASE 1.1 ‚Äî VALIDATION & CONTENT SAFETY MASTER PROMPT

(MANDATORY ‚Äî DO NOT PROCEED TO PHASE 2 UNTIL COMPLETE)

You are implementing Phase 1.1: Validation & Content Safety Hardening for the KIOSK Marketplace.

‚ö†Ô∏è CRITICAL RULES
	‚Ä¢	DO NOT introduce new features
	‚Ä¢	DO NOT redesign UI layouts
	‚Ä¢	DO NOT touch payments, checkout, OAuth, Smile ID, or APIs outside validation
	‚Ä¢	DO NOT mark this task complete unless EVERY checklist item passes manual testing

This phase exists to make the platform safe, compliant, and production-ready before money or identity APIs are introduced.

‚∏ª

========================================

SECTION 0 ‚Äî NON-NEGOTIABLE PRINCIPLES

========================================
	1.	ALL validation must be enforced server-side
	‚Ä¢	Client-side validation is ONLY for UX
	‚Ä¢	Server is the final authority
	2.	All validation failures must return structured errors

{
  code: string,
  message: string
}


	3.	The UI MUST display the server error message verbatim
	‚Ä¢	No generic ‚ÄúPlease try again‚Äù
	‚Ä¢	No swallowed errors
	‚Ä¢	No console-only failures

‚∏ª

========================================

SECTION 1 ‚Äî PHONE NUMBER VALIDATION (CRITICAL)

========================================

Scope:

Applies to:
	‚Ä¢	User registration (buyer, vendor, admin)
	‚Ä¢	Profile updates
	‚Ä¢	Checkout (future compatibility)

Requirements:
	‚Ä¢	Enforce E.164 format OR a clearly defined Ghana format
	‚Ä¢	Reject:
	‚Ä¢	Letters
	‚Ä¢	Symbols (except + where applicable)
	‚Ä¢	Too short / too long numbers
	‚Ä¢	Normalize phone numbers before storage

Failure Behavior:
	‚Ä¢	Server rejects invalid numbers with:

{
  "code": "INVALID_PHONE",
  "message": "Please enter a valid phone number"
}


	‚Ä¢	Client shows this message inline

‚∏ª

========================================

SECTION 2 ‚Äî OFFENSIVE & CONTACT CONTENT FILTERING (CRITICAL)

========================================

MUST BLOCK the following content types:
	‚Ä¢	Profanity
	‚Ä¢	Sexual language
	‚Ä¢	Hate speech / slurs
	‚Ä¢	Harassment
	‚Ä¢	Phone numbers
	‚Ä¢	Email addresses
	‚Ä¢	URLs
	‚Ä¢	WhatsApp / Telegram / social handles

Applies to ALL of the following fields:
	‚Ä¢	Product name
	‚Ä¢	Product description
	‚Ä¢	Review text
	‚Ä¢	Vendor store name
	‚Ä¢	Vendor store description
	‚Ä¢	Coupon names
	‚Ä¢	Sale names
	‚Ä¢	Any free-text promotional content

Implementation Rules:
	‚Ä¢	Filtering MUST occur server-side
	‚Ä¢	Client-side checks are OPTIONAL but not sufficient
	‚Ä¢	Use a centralized content validation utility
	‚Ä¢	No hardcoded checks scattered across files

Failure Response Example:

{
  "code": "UNSAFE_CONTENT",
  "message": "This field contains prohibited or unsafe content"
}


‚∏ª

========================================

SECTION 3 ‚Äî ADDRESS VALIDATION (BASELINE)

========================================

‚ö†Ô∏è This is NOT Google Maps yet.

Requirements:
	‚Ä¢	Required address fields MUST NOT be empty
	‚Ä¢	Reject obvious garbage input (e.g. ‚Äúasdfasdf‚Äù, ‚Äú123123123‚Äù)
	‚Ä¢	Enforce minimum character length where applicable
	‚Ä¢	Normalize whitespace

Applies to:
	‚Ä¢	Buyer addresses
	‚Ä¢	Vendor addresses
	‚Ä¢	Checkout address form

‚∏ª

========================================

SECTION 4 ‚Äî ERROR SURFACING & UX CONSISTENCY

========================================

Fix ALL instances where:
	‚Ä¢	Server returns a specific error
	‚Ä¢	Client replaces it with a generic fallback

Example of INCORRECT behavior:

Server: "Quantity must be zero or a positive number"
UI: "Failed to create product, please try again"

Required Behavior:
	‚Ä¢	UI MUST show "Quantity must be zero or a positive number"

Audit:
	‚Ä¢	Product creation
	‚Ä¢	Product editing
	‚Ä¢	Promotions
	‚Ä¢	Reviews
	‚Ä¢	Authentication flows

‚∏ª

========================================

SECTION 5 ‚Äî CENTRALIZED VALIDATION ARCHITECTURE

========================================

Implement:
	‚Ä¢	A shared validation module (e.g. lib/validation)
	‚Ä¢	Reusable helpers for:
	‚Ä¢	Phone validation
	‚Ä¢	Content safety checks
	‚Ä¢	Address checks

‚ùå NO duplicated regex logic across routes
‚ùå NO inline profanity lists scattered in code

‚∏ª

========================================

SECTION 6 ‚Äî LOGGING & SECURITY

========================================
	‚Ä¢	Validation failures:
	‚Ä¢	Must NOT log raw offensive content
	‚Ä¢	May log error codes and entity type
	‚Ä¢	Never log:
	‚Ä¢	Passwords
	‚Ä¢	Phone numbers
	‚Ä¢	Emails
	‚Ä¢	Review content

‚∏ª

========================================

SECTION 7 ‚Äî MANDATORY MANUAL TESTING

========================================

Use THESE credentials during testing:
	‚Ä¢	Admin: the3rdukem@gmail.com / 123asdqweX$
	‚Ä¢	Vendor: ven@kiosk.com.gh / 123asdqwe
	‚Ä¢	Buyer: buy@kiosk.com.gh / 123asdqwe

Tests that MUST pass:

Phone Validation
	‚Ä¢	Invalid phone ‚Üí rejected with clear message
	‚Ä¢	Valid phone ‚Üí saved correctly

Offensive Content
	‚Ä¢	Product name: "fuck you" ‚Üí ‚ùå rejected
	‚Ä¢	Description with phone/email ‚Üí ‚ùå rejected
	‚Ä¢	Clean content ‚Üí ‚úÖ accepted

Error Messaging
	‚Ä¢	Quantity = -2 ‚Üí UI shows exact server message
	‚Ä¢	Invalid discount ‚Üí UI shows exact server message

Address
	‚Ä¢	Empty required address ‚Üí ‚ùå rejected
	‚Ä¢	Garbage input ‚Üí ‚ùå rejected

‚∏ª

========================================

FINAL COMPLETION RULE

========================================

üö´ DO NOT report this task as complete unless:
	‚Ä¢	Offensive content is blocked server-side
	‚Ä¢	Phone numbers are strictly validated
	‚Ä¢	Address fields have baseline validation
	‚Ä¢	UI displays server error messages exactly
	‚Ä¢	No generic ‚Äútry again‚Äù messages remain


‚∏ª

If you want, once this finishes, I‚Äôll audit the agent‚Äôs output line-by-line before you move forward.