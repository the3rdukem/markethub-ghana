
üîí PHASE 1 ‚Äî FINAL STABILITY FIX

Admin Products Crash (Radix Select / Empty Category) ‚Äî MASTER PROMPT

CONTEXT (READ CAREFULLY ‚Äî DO NOT SKIP)

There is a confirmed root cause for the Admin ‚Üí Products Management crash:
	‚Ä¢	Admin Products page renders a Category Filter <Select> on load
	‚Ä¢	Categories are derived from existing products
	‚Ä¢	Some products (drafts / legacy) have category = "" (empty string) in the database
	‚Ä¢	Radix UI hard-crashes when any <Select.Item value=""> is rendered
	‚Ä¢	This propagates through ClientProvider ‚Üí RootLayout ‚Üí ErrorBoundary

This is NOT a form issue.
This is a read-side data normalization failure.

‚∏ª

üéØ OBJECTIVE (NON-NEGOTIABLE)

Eliminate all possible paths where an empty string category can crash the UI ‚Äî now and in the future.

This fix must be:
	‚Ä¢	Database-safe
	‚Ä¢	API-defensive
	‚Ä¢	UI-hardened
	‚Ä¢	Regression-proof

‚∏ª

‚úÖ REQUIRED FIXES (ALL MUST BE DONE)

PART A ‚Äî DATABASE SANITIZATION (ONE-TIME FIX)

Run a safe, idempotent cleanup to remove illegal empty-string categories:

UPDATE products
SET category = NULL
WHERE category = '';

	‚Ä¢	Do NOT introduce defaults
	‚Ä¢	NULL is the only allowed ‚Äúunset‚Äù state
	‚Ä¢	This prevents future crashes from legacy data

‚∏ª

PART B ‚Äî READ API NORMALIZATION (MANDATORY)

On all product list APIs (including admin endpoints):
	‚Ä¢	NEVER return empty strings for enum-like fields
	‚Ä¢	Normalize product.category on read

Rule:

category: product.category || null

This must apply to:
	‚Ä¢	/api/products
	‚Ä¢	/api/admin/products
	‚Ä¢	Any endpoint returning product lists

‚ö†Ô∏è Even if the DB is clean, the API must remain defensive.

‚∏ª

PART C ‚Äî ADMIN UI HARDENING (CRITICAL)

In Admin ‚Üí Products Management:
	‚Ä¢	When building Category Filter <Select> options:
	‚Ä¢	Ignore null
	‚Ä¢	Ignore ""
	‚Ä¢	Ignore whitespace-only values
	‚Ä¢	Deduplicate safely

No <Select.Item> may EVER receive:

value === ""

If a category is invalid, it must simply not render.

‚ùå Do NOT use try/catch
‚ùå Do NOT weaken Radix
‚ùå Do NOT default empty strings to ‚ÄúAll‚Äù

‚∏ª

PART D ‚Äî REGRESSION PROTECTION

Add a guard (test or runtime assertion) to ensure:
	‚Ä¢	No <Select.Item value=""> can be rendered anywhere in admin
	‚Ä¢	Draft products with category = NULL do NOT crash admin pages

This can be:
	‚Ä¢	A simple invariant check
	‚Ä¢	Or a small unit/integration test

‚∏ª

üß™ MANDATORY TESTING (USE THESE CREDENTIALS)

You MUST manually test with the following accounts:

Admin
	‚Ä¢	Email: the3rdukem@gmail.com
	‚Ä¢	Password: 123asdqweX$

Vendor
	‚Ä¢	Email: ven@kiosk.com.gh
	‚Ä¢	Password: 123asdqwe

Buyer
	‚Ä¢	Email: buy@kiosk.com.gh
	‚Ä¢	Password: 123asdqwe

Test Checklist (ALL REQUIRED):
	‚Ä¢	Admin ‚Üí Products page loads without crash
	‚Ä¢	Category filter renders correctly
	‚Ä¢	Products with NULL category do not appear in filter
	‚Ä¢	Vendor draft products do not crash admin
	‚Ä¢	No Radix Select errors in console
	‚Ä¢	No ErrorBoundary triggers

‚∏ª

üö® REPORTING RULES (STRICT)

When you report completion:
	‚Ä¢	Do NOT say ‚Äúshould work‚Äù
	‚Ä¢	Do NOT say ‚Äúlikely fixed‚Äù
	‚Ä¢	Explicitly confirm:
	‚Ä¢	DB cleanup executed
	‚Ä¢	API normalization applied
	‚Ä¢	Admin Select hardened
	‚Ä¢	Manual tests completed with credentials above

If any part is incomplete, report it as FAILED, not ‚Äúpartial‚Äù.

‚∏ª

üß± SCOPE LOCK
	‚Ä¢	‚ùå No new features
	‚Ä¢	‚ùå No UI redesign
	‚Ä¢	‚ùå No form changes
	‚Ä¢	‚ùå No category admin changes

This task exists only to close Phase 1 stability.

‚∏ª

‚úÖ SUCCESS CRITERIA

Admin Products Management never crashes, regardless of:
	‚Ä¢	Draft products
	‚Ä¢	Legacy data
	‚Ä¢	Missing categories
