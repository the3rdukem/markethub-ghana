Validation, Auth Hardening & Data Integrity

(NO payments, NO new features, NO UI redesigns beyond validation feedback)

â¸»

ðŸš« ABSOLUTE RULES (READ FIRST)
	1.	DO NOT introduce new features
	2.	DO NOT refactor unrelated files
	3.	DO NOT touch payments, Paystack, coupons, sales, or checkout
	4.	DO NOT mark anything â€œfixedâ€ without reproducing and verifying
	5.	DO NOT rely on Zustand/localStorage for validation
	6.	ALL validation must be enforced server-side first
	7.	Client-side validation is UX only â€” never the source of truth

If any rule is violated, stop and report before proceeding.

â¸»

ðŸŽ¯ PHASE 1 OBJECTIVE

Create a production-grade validation and auth integrity layer that guarantees:
	â€¢	No invalid data can enter the system
	â€¢	No duplicate or conflicting accounts can exist
	â€¢	All auth flows behave deterministically
	â€¢	All failures return clear, user-friendly messages
	â€¢	No silent failures
	â€¢	No ghost records
	â€¢	No inconsistent identity states

â¸»

ðŸ“¦ SCOPE OF WORK (ONLY THESE)

1ï¸âƒ£ AUTH & IDENTITY VALIDATION (CRITICAL)

Email
	â€¢	Must be valid RFC email format
	â€¢	Case-insensitive uniqueness
	â€¢	Same email cannot register twice:
	â€¢	EXCEPT: one Buyer + one Vendor account allowed
	â€¢	Admin emails must be globally unique
	â€¢	Clear error messages:
	â€¢	â€œThis email is already registered as a buyerâ€
	â€¢	â€œThis email already exists as an adminâ€

Password
	â€¢	Minimum 8 characters
	â€¢	Must include:
	â€¢	1 uppercase
	â€¢	1 lowercase
	â€¢	1 number
	â€¢	Enforced server-side
	â€¢	Client shows real-time feedback

Login
	â€¢	Correct error differentiation:
	â€¢	Email not found
	â€¢	Wrong password
	â€¢	Account suspended
	â€¢	No generic â€œInvalid credentialsâ€

Logout
	â€¢	Fully deterministic:
	â€¢	Session destroyed
	â€¢	Cart cleared
	â€¢	User state reset
	â€¢	No cross-user leakage (already seen before â€” verify again)

â¸»

2ï¸âƒ£ ROLE & ACCOUNT CONSISTENCY
	â€¢	Buyer, Vendor, Admin identities must be:
	â€¢	Mutually exclusive where required
	â€¢	Clearly resolved at login
	â€¢	Admin-created users:
	â€¢	Must persist
	â€¢	Must appear in admin lists
	â€¢	Must login immediately
	â€¢	Prevent role drift (e.g. vendor logging in as buyer)

â¸»

3ï¸âƒ£ FORM VALIDATION (SYSTEM-WIDE)

Apply to ALL forms, including:
	â€¢	Signup
	â€¢	Login
	â€¢	Product creation/edit
	â€¢	Reviews
	â€¢	Promotions
	â€¢	Profile edits

Rules:
	â€¢	Required fields enforced server-side
	â€¢	Numeric fields validated (price > 0, quantity â‰¥ 0)
	â€¢	Dates validated (start < end)
	â€¢	Empty strings normalized to NULL
	â€¢	No null.trim() errors anywhere

â¸»

4ï¸âƒ£ DATABASE CONSTRAINTS (NON-NEGOTIABLE)

Add or verify:
	â€¢	Unique indexes (email + role logic)
	â€¢	Foreign key constraints
	â€¢	NOT NULL where appropriate
	â€¢	Safe defaults

If DB constraints conflict with existing data:
	â€¢	Report clearly
	â€¢	Do NOT auto-delete records

â¸»

5ï¸âƒ£ ERROR HANDLING & FEEDBACK

Every failure must:
	â€¢	Return a structured error { code, message }
	â€¢	Display a user-friendly toast or inline error
	â€¢	Never silently fail
	â€¢	Never log {} as an error

â¸»

ðŸ§ª MANDATORY TESTING (USE THESE ACCOUNTS)

You MUST manually test every scenario below using:
	â€¢	Admin: the3rdukem@gmail.com / 123asdqweX$
	â€¢	Vendor: ven@kiosk.com.gh / 123asdqwe
	â€¢	Buyer: buy@kiosk.com.gh / 123asdqwe

Required Tests (All Must Pass):
	â€¢	Duplicate email registration (buyer â†’ buyer, buyer â†’ vendor, vendor â†’ admin)
	â€¢	Weak password rejection
	â€¢	Invalid email rejection
	â€¢	Admin creates admin â†’ appears â†’ logs in
	â€¢	Logout â†’ login as different user â†’ no state bleed
	â€¢	Form submission with missing required fields
	â€¢	Product edit with empty description (no crash)
	â€¢	Review edit/delete time window respected (if applicable)
	â€¢	Validation errors show correct messages

â¸»

ðŸ§¾ FINAL REPORT FORMAT (STRICT)

You must return:

âœ… What Was Fixed

(List with file paths and reasons)

ðŸ§ª What Was Tested

(Explicit scenarios + which account was used)

âŒ What Was NOT Touched

(To confirm scope discipline)

âš ï¸ Known Limitations

(If anything is deferred)

ðŸ›‘ Verification Statement

â€œI have manually verified each item above and confirm no silent failures remain.â€

If this statement cannot be made truthfully â€” STOP.