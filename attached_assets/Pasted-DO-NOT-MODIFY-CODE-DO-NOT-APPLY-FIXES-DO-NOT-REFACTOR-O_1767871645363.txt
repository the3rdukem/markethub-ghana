DO NOT MODIFY CODE.
DO NOT APPLY FIXES.
DO NOT REFACTOR.
OBSERVE AND REPORT ONLY.

‚∏ª

üîç DIAGNOSTIC PROMPT ‚Äî ADMIN NAVIGATION COUNTS FAILURE

You are analyzing the KIOSK Marketplace codebase on Replit.

Your task is READ-ONLY.

‚ùå Do NOT change code
‚ùå Do NOT ‚Äúfix‚Äù anything
‚ùå Do NOT refactor
‚ùå Do NOT suggest future features

Your ONLY goal is to identify why admin navigation tab counts do not update or reset correctly.

‚∏ª

=====================================

SECTION 1 ‚Äî TRACE DATA FLOW (MANDATORY)

=====================================

For EACH admin navigation tab badge (Users, Vendors, Products, Orders):
	1.	Identify:
	‚Ä¢	Component file rendering the count
	‚Ä¢	Data source (server component, client fetch, server action, API route)
	‚Ä¢	Query or function name
	2.	State explicitly:
	‚Ä¢	Where the count value originates
	‚Ä¢	Whether it comes from:
	‚Ä¢	DB query
	‚Ä¢	Cached selector
	‚Ä¢	Layout-level data
	‚Ä¢	Hardcoded placeholder
	‚Ä¢	Derived client state

Output format per tab:

TAB: Products
Component:
Data Source:
Query Used:
Caching Behavior:
Observed Issue:


‚∏ª

=====================================

SECTION 2 ‚Äî LAYOUT & CACHE ANALYSIS

=====================================

Analyze admin layout and navigation reuse:
	‚Ä¢	Is the admin layout:
	‚Ä¢	Static?
	‚Ä¢	Cached?
	‚Ä¢	Reused across sessions?
	‚Ä¢	Does it fetch data at build-time or request-time?
	‚Ä¢	Does it re-run queries on login/logout?

Answer explicitly:
	‚Ä¢	Does the admin nav component EVER re-fetch after first render?
	‚Ä¢	Is it using useMemo, useState, or persisted props?

‚∏ª

=====================================

SECTION 3 ‚Äî SESSION & AUTH BOUNDARIES

=====================================

Inspect:
	‚Ä¢	How last_admin_login_at is stored
	‚Ä¢	Where it is read
	‚Ä¢	Whether nav counts read it at all

Answer:
	‚Ä¢	Is last_admin_login_at read server-side or client-side?
	‚Ä¢	Is it read once or per request?
	‚Ä¢	Can it be stale across logins?

‚∏ª

=====================================

SECTION 4 ‚Äî COMPARE WITH WORKING COUNTS

=====================================

Compare:
	‚Ä¢	Navigation tab counts ‚ùå
	‚Ä¢	Dashboard tiles ‚úÖ
	‚Ä¢	Per-page counts ‚úÖ

Identify:
	‚Ä¢	Differences in:
	‚Ä¢	Queries
	‚Ä¢	Filters
	‚Ä¢	Cache policies
	‚Ä¢	Component lifecycle

Explain why dashboard tiles are correct but nav tabs are not.

‚∏ª

=====================================

SECTION 5 ‚Äî DB VS UI CONSISTENCY CHECK

=====================================

For each count:
	‚Ä¢	Provide the exact SQL (or query logic) used
	‚Ä¢	State:
	‚Ä¢	Does the DB return the expected value?
	‚Ä¢	Does the UI receive it?
	‚Ä¢	If yes ‚Üí where does it change?

‚∏ª

=====================================

SECTION 6 ‚Äî ROOT CAUSE STATEMENT (REQUIRED)

=====================================

End your report with:

ROOT CAUSE:
<single paragraph, no speculation>

It must name:
	‚Ä¢	The exact mechanism failing (e.g. cached layout, stale server props, client-only state)
	‚Ä¢	The exact file(s) responsible
	‚Ä¢	Why previous ‚Äúfixes‚Äù appeared to work briefly but reverted

‚∏ª

=====================================

SECTION 7 ‚Äî NO FIXES ALLOWED

=====================================

Do NOT:
	‚Ä¢	Add code
	‚Ä¢	Change cache settings
	‚Ä¢	Propose solutions

This is a forensic report only.

‚∏ª

üß† WHY THIS MATTERS (FOR YOU)

Right now, you have symptoms, not clarity.

This prompt will tell us:
	‚Ä¢	Whether Replit is caching layouts aggressively
	‚Ä¢	Whether admin nav is effectively ‚Äústatic‚Äù
	‚Ä¢	Whether login boundaries are being crossed incorrectly
	‚Ä¢	Whether you‚Äôre fighting Next.js behavior instead of a bug

Once we get the report:
	‚Ä¢	The fix will be small
	‚Ä¢	The fix will be permanent
	‚Ä¢	You won‚Äôt be charged repeatedly for ‚Äúphantom fixes‚Äù

‚∏ª