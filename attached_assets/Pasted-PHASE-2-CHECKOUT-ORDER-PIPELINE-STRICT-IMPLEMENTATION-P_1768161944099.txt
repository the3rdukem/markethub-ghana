PHASE 2 ‚Äî CHECKOUT & ORDER PIPELINE (STRICT IMPLEMENTATION PROMPT)

THIS IS PHASE 2 ONLY.
NO PAYMENTS.
NO PAYSTACK.
NO EXTERNAL APIs.
NO UI POLISH.

‚∏ª

üéØ PHASE 2 OBJECTIVE

Build a complete, stable, and auditable checkout ‚Üí order pipeline WITHOUT payment processing.

At the end of Phase 2:
	‚Ä¢	Orders can be created
	‚Ä¢	Orders are persisted correctly
	‚Ä¢	Order state transitions are correct
	‚Ä¢	Vendor/Admin/Buyer order visibility works
	‚Ä¢	The system is payment-ready but payment-disabled

‚∏ª

üö´ HARD RULES (NON-NEGOTIABLE)

‚ùå Do NOT integrate Paystack
‚ùå Do NOT simulate payments
‚ùå Do NOT auto-complete orders
‚ùå Do NOT change cart logic
‚ùå Do NOT add new roles
‚ùå Do NOT redesign UI
‚ùå Do NOT refactor unrelated code

If something is missing, report it ‚Äî do not invent it.

‚∏ª

‚úÖ SCOPE ‚Äî WHAT MUST BE IMPLEMENTED

‚∏ª

1Ô∏è‚É£ ORDER DATA MODEL (MANDATORY)

Implement or verify a database-backed orders system with:

Orders Table

Required fields:
	‚Ä¢	id
	‚Ä¢	buyer_id
	‚Ä¢	status (pending_payment, cancelled, fulfilled)
	‚Ä¢	subtotal
	‚Ä¢	discount_total
	‚Ä¢	shipping_fee
	‚Ä¢	total
	‚Ä¢	created_at
	‚Ä¢	updated_at

Order Items Table
	‚Ä¢	order_id
	‚Ä¢	product_id
	‚Ä¢	vendor_id
	‚Ä¢	quantity
	‚Ä¢	unit_price
	‚Ä¢	applied_discount
	‚Ä¢	final_price

‚úî Orders must support multi-vendor carts
‚úî Each order item must be vendor-scoped

‚∏ª

2Ô∏è‚É£ CHECKOUT FLOW (NO PAYMENT)

Buyer Flow
	‚Ä¢	Cart ‚Üí Checkout page
	‚Ä¢	Enter:
	‚Ä¢	Shipping address
	‚Ä¢	Contact phone
	‚Ä¢	Apply coupon (already implemented)
	‚Ä¢	Review order summary
	‚Ä¢	Click ‚ÄúPlace Order‚Äù

Result:
	‚Ä¢	Order created with status: pending_payment
	‚Ä¢	Cart is cleared ONLY after successful order creation
	‚Ä¢	Buyer redirected to Order Confirmation page

‚ùå No money charged
‚ùå No fake success states

‚∏ª

3Ô∏è‚É£ ORDER VISIBILITY (CRITICAL)

Buyer
	‚Ä¢	/buyer/orders
	‚Ä¢	View:
	‚Ä¢	All orders
	‚Ä¢	Order details
	‚Ä¢	Status
	‚Ä¢	Cannot modify orders

Vendor
	‚Ä¢	/vendor/orders
	‚Ä¢	Sees ONLY items belonging to them
	‚Ä¢	Can:
	‚Ä¢	View order items
	‚Ä¢	Update fulfillment status (fulfilled only)
	‚Ä¢	Cannot cancel orders

Admin
	‚Ä¢	/admin/orders
	‚Ä¢	Full visibility
	‚Ä¢	Can:
	‚Ä¢	Cancel orders
	‚Ä¢	View audit trail

‚∏ª

4Ô∏è‚É£ STATUS RULES (STRICT)

Allowed transitions:

pending_payment ‚Üí cancelled (admin only)
pending_payment ‚Üí fulfilled (vendor only, per item)

‚ùå No skipping states
‚ùå No auto-advancement

‚∏ª

5Ô∏è‚É£ INVENTORY HANDLING
	‚Ä¢	Inventory is reserved at order creation
	‚Ä¢	Quantity is decremented when order is created
	‚Ä¢	If order is cancelled ‚Üí inventory restored
	‚Ä¢	Prevent overselling

‚∏ª

6Ô∏è‚É£ AUDIT LOGGING (MANDATORY)

Log the following actions:
	‚Ä¢	Order created
	‚Ä¢	Order cancelled
	‚Ä¢	Order fulfilled (per vendor item)

Each log must include:
	‚Ä¢	actor_role
	‚Ä¢	actor_id
	‚Ä¢	action
	‚Ä¢	order_id
	‚Ä¢	timestamp

‚∏ª

7Ô∏è‚É£ ERROR HANDLING
	‚Ä¢	All checkout failures must return field-specific errors
	‚Ä¢	No console crashes
	‚Ä¢	No silent failures
	‚Ä¢	No toast spam

‚∏ª

8Ô∏è‚É£ EXPLICITLY OUT OF SCOPE

‚ùå Payments
‚ùå Paystack
‚ùå Webhooks
‚ùå Invoices
‚ùå Email notifications
‚ùå Refunds
‚ùå Shipping APIs

‚∏ª

üß™ TESTING REQUIREMENTS (MANDATORY)

Use ONLY these accounts:
	‚Ä¢	Admin: the3rdukem@gmail.com / 123asdqweX$
	‚Ä¢	Vendor: ven@kiosk.com.gh / 123asdqwe
	‚Ä¢	Buyer: buy@kiosk.com.gh / 123asdqwe

Test:
	‚Ä¢	Single-vendor order
	‚Ä¢	Multi-vendor order
	‚Ä¢	Coupon application
	‚Ä¢	Inventory decrement
	‚Ä¢	Order visibility per role
	‚Ä¢	Order cancellation (admin)
	‚Ä¢	Fulfillment (vendor)

‚∏ª

üìÑ REPORTING FORMAT (MANDATORY)

For each section:

[SECTION]: PASS

or

[SECTION]: FAIL
File:
Line:
Cause:

Final line must be ONE of:

PHASE 2 COMPLETE ‚Äî READY FOR PAYMENTS

or

PHASE 2 BLOCKED ‚Äî REASON LISTED ABOVE


‚∏ª

‚ö†Ô∏è FINAL WARNING

Any work outside this scope invalidates Phase 2.

This phase must end with:
‚úî Stable orders
‚úî Correct inventory
‚úî Clean role boundaries
‚úî Zero payment logic